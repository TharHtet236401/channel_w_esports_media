{% extends "base.html" %}

{% block title %}Posts Admin Dashboard — Channel W{% endblock %}

{% block content %}
<section class="bg-base-200/60 border-b border-base-300/60">
    <div class="container mx-auto px-4 py-8 md:py-10">
        <div class="flex items-center justify-between gap-4">
            <div>
                <p class="text-xs font-semibold tracking-[0.2em] uppercase text-primary mb-1">
                    Admin
                </p>
                <h1 class="text-2xl md:text-3xl font-extrabold tracking-tight text-base-content">
                    Posts Dashboard
                </h1>
                <p class="text-sm md:text-base text-base-content/70 mt-1">
                    Manage posts — create, update, delete, and view details with HTMX.
                </p>
            </div>
        </div>
    </div>
</section>

<section class="container mx-auto px-4 py-8 md:py-10">
    {% if error %}
        <div class="alert alert-error mb-6">
            <span>{{ error }}</span>
        </div>
    {% endif %}

    <div class="card bg-base-100 shadow-lg border border-base-300/70 rounded-2xl">
        <div class="card-body p-4 md:p-6 space-y-4">
            <div class="flex items-center justify-between mb-4 gap-3">
                <h2 class="card-title text-base md:text-lg font-bold">All Posts</h2>
                <button
                    class="btn btn-sm btn-primary rounded-full gap-2 shadow-md"
                    hx-get="{% url 'post_admin_create' %}"
                    hx-target="#post-modal-content"
                    hx-swap="innerHTML"
                    hx-on::after-request="document.getElementById('post-modal').showModal()"
                >
                    New Post
                </button>
            </div>

            <div id="post-table" class="mt-2">
                {% include "posts/admin/partials/post_table.html" with posts=posts %}
            </div>
        </div>
    </div>

    <!-- Modal for view / edit / create -->
    <dialog id="post-modal" class="modal">
        <div class="modal-box max-w-2xl rounded-2xl" id="post-modal-content">
            <!-- HTMX loads form or detail here -->
        </div>
        <form method="dialog" class="modal-backdrop">
            <button>Close</button>
        </form>
    </dialog>
</section>
{% endblock %}

